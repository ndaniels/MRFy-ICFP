vee' Ins (NC 0) i = intoInsZero i
vee' Mat (NC 1) i = intoMatOne i
vee' Del (NC 1) i = intoDelOne i
vee' stateHat j i =
  internal [ edge score state (vee'' state pj pi)
           | state <- preceders stateHat
           , let pi = case state of { Del -> i ; _ -> pred i }
           , pj >= 0, pi >= 0
           , let score = transition (node pj) state stateHat
                         + emission (node pj) state (residue pi)
           ]
  where pj = case stateHat of { Ins -> j ; _ -> pred j }
